---
title: "Knowledge Quiz 2"
subtitle: "Jessica Schmidt"
format:
  pdf: default
editor_options: 
  chunk_output_type: console
---

Please answer the following questions, render a pdf, and submit via moodle by 11 PM on Fri Oct 24.

Guidelines: 

- No consulting with anyone else (other than clarification questions from Professor Roback)
- You may use only materials from this class (our class webpage, links on moodle, our 3 online textbooks, files posted to the RStudio server)
- No online searches or use of large language models like ChatGPT

Pledge: 

I pledge my honor that on this quiz I have neither given nor received assistance not explicitly approved by the professor and that I an aware of no dishonest work.

- type your name here to acknowledge the pledge: Jessica Schmidt
- OR
- place an X here if you intentionally are not signing the pledge: _______

```{r}
#| message: false
#| warning: false

library(tidyverse)
```


1. Here's is a crazy list that tells you some stuff about data science.  Give code that will produce **exactly** the following outputs.

```{r}
data_sci <- list(
  first = c("first it must work", "then it can be" , "pretty"),
  DRY = c("Do not", "Repeat", "Yourself"),
  dont_forget = c("garbage", "in", "out"),
  our_first_tibble = mpg,
  integers = 1:25,
  doubles = sqrt(1:25),
  tidyverse = c(pack1 = "ggplot2", 
                pack2 = "dplyr", 
                pack3 = "lubridate", 
                etc = "and more!"),
  opinion = list("SDS 264 is",  
                 c("awesome!", "amazing!", "rainbows!"))
)

str(data_sci)
```

[1] "Do not"   "Yourself" "Repeat"  

```{r}
data_sci$DRY[c(1,3,2)]
```


# A tibble: 10 Ã— 2
   trans      mean_cty
   <chr>         <dbl>
 1 auto(av)       20  
 2 auto(l3)       21  
 3 auto(l4)       15.9
 4 auto(l5)       14.7
 5 auto(l6)       13.7
 6 auto(s4)       18.7
 7 auto(s5)       17.3
 8 auto(s6)       17.4
 9 manual(m5)     19.3
10 manual(m6)     16.9

```{r}
data_sci$our_first_tibble |>
  group_by(trans) |>
  summarize(mean_cty = mean(cty))
```


 [1] 3.162278 3.316625 3.464102 3.605551 3.741657 3.872983 4.000000
 [8] 4.123106 4.242641 4.358899 4.472136 4.582576 4.690416 4.795832
[15] 4.898979 5.000000

```{r}
data_sci$doubles[10:25]
```


[1] "SDS 264 is awesome!"

```{r}
str_c(data_sci$opinion[1], " ", data_sci$opinion[[2]][1])
```


2. Write a function called `popularity_factors()` that allows a user to input a tibble, an artist name, and a numeric variable in that tibble that could serve as a predictor of `track_popularity`.  Your function should produce a scatterplot of the user's predictor on the x-axis, `track_popularity` on the y-axis, and a smoother through the points (where `se = FALSE` is the default unless changed by the user).  Your plot title should reflect the artist chosen by the user, and if the chosen artist is not found in the data set, your function should return an error.

```{r}
popularity_factors <- function(df, artist, x, se = FALSE){
  if (artist %in% df$track_artist) {
    label <- rlang::englue("Songs by {{artist}}")
    df |>
      filter(track_artist == artist) |>
      ggplot(aes(x = {{x}}, y = track_popularity)) +
        geom_point() +
        geom_smooth(se = se) +
        labs(title = label)
  } else {
    stop("Artist not listed in the data set", call. = FALSE)
  }
}
```


```{r}
#| error: TRUE

bigspotify <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-01-21/spotify_songs.csv')

bigspotify

popularity_factors(df = bigspotify, 
                   artist = "Ed Sheeran",
                   x = duration_ms)
# Works!  See KQ2_plot.png

popularity_factors(df = bigspotify, 
                   artist = "Edward Sheeran",
                   x = duration_ms)
# Throws an error that says "Artist not listed in the data set"

```


3. The Central Limit Theorem is one of the most amazing results in all of mathematics.  It says that if you take random samples from any population, if the sample size is large enough, the sample means will follow a normal distribution.  This is true no matter how not-normal the original population is - crazy but true!!  Let's explore the CLT in two steps.

```{r}
# Histogram of skewed population we're sampling from
skewed <- rexp(10000, rate = 0.2)
tibble(skewed = skewed) |>
  ggplot(aes(x = skewed)) +
  geom_histogram()
```

a) Write a for loop that takes 10,000 samples of size 30 from a skewed distribution and then plots the 10,000 means in a histogram to let us see if the histogram follows a normal distribution.  Here are a couple of hints:

- `rexp(30, rate = 0.2)` will produce a random sample of size 30 from a skewed distribution
- `tibble(x = x)` will take a vector `x` and turn it into a column of a tibble that can be used in `ggplot`

```{r}
means = vector("double", 10000)
for (i in 1:10000) {
  sample = rexp(30, rate = 0.2)
  means[i] = mean(sample)
}
ggplot(tibble(means = means), aes(x = means)) +
  geom_histogram()
```


b) Turn your for loop from (a) into a function whose attributes are `samp_size` with default of 30, and `n_means` with default of 10000.  In addition, your histogram should now have a title that says "Means from samples of size 30 from a skewed population", where 30 is replaced with the user's input.

```{r}
clt <- function(samp_size = 30, n_means = 10000){
  means = vector("double", n_means)
  for (i in 1:n_means) {
    sample = rexp(samp_size, rate = 0.2)
    means[i] = mean(sample)
  }
  label <- rlang::englue("Means from samples of size {{samp_size}} from a skewed population")
  ggplot(tibble(means), aes(x = means)) +
      geom_histogram() + 
      labs(title = label)
}
clt()
clt(samp_size = 40)
```


